{{#if products}}

<section class="container">
    <!-- cart menu -->
    <div class="p-3 mb-5">
        <ul class="nav justify-content-center">
            <li class="nav-item">
                <a class="nav-link text-secondary" href="/cart">Shopping cart</a>
            </li>
            <li class="nav-item menu-cart">
                <a class="nav-link text-secondary" href="/cart/checkout">Checkout</a>
            </li>
        </ul>
    </div>

    <form action="/cart/checkout?_method=PUT" method="POST">

        <div class="row">
            <!-- shipping details -->
            <div class="col-md-7 col-lg-8 mb-5">
                <h1 class="h3 mb-3">Shipping details</h1>
                <hr class="mb-5">
                <!-- address -->
                <div>
                    <form action="/cart/shipping" class="row g-3">
                        {{#if customer}}
                        <fieldset disabled>
                            <div class="col-12 mb-3">
                                <input type="hidden" id="id" name="id" value="{{customer.id}}">
                                <input type="text" class="form-control" id="firstName" name="firstName"
                                    value="{{customer.name}}">
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <input type="text" class="form-control" id="address" placeholder="1234 Main St"
                                        name="address" value="{{customer.address}}">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <input type="text" class="form-control" id="city" name="city"
                                        value="{{customer.city}}">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <input type="text" class="form-control" id="state" name="state"
                                        value="{{customer.state}}">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <input type="text" class="form-control" id="zip" name="zip_code"
                                        value="{{customer.zip_code}}">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <input type="phone" class="form-control" id="phone" name="phone"
                                        value="{{customer.phone}}">
                                </div>
                                <div class="col-md-6">
                                    <input type="email" class="form-control" id="newEmail" name="email"
                                        value="{{customer.email}}">
                                </div>
                            </div>
                        </fieldset>
                        {{/if}}
                    </form>
                </div>
                <hr class="my-5">

                <!-- shipping -->
                <div class="d-flex justify-content-center mb-5">
                    <div class="border p-3 mx-3">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="shipping" id="free" value="1" checked
                                onchange="setShipping('Free')">
                            <label class="form-check-label" for="inlineRadio1">Free Shipping
                                <p class="text-muted small mb-0">Between 2-5 working days</p>
                            </label>
                        </div>
                    </div>
                    <div class="border p-3 mx-3">
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="shipping" id="nextDay" value="0"
                                onchange="setShipping(`20.00`)">
                            <label class="form-check-label" for="inlineRadio2">Next Day Delivery $20
                                <p class="text-muted small mb-0">24 hours from checkout</p>
                            </label>
                        </div>
                    </div>


                </div>

                <!-- payment -->
                <div class="py-5">
                    <h1 class="h3 mb-3">Payment method</h1>
                    <hr class="mb-5">
                    <div class="border p-3 mx-3">

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="payment" id="card" value="card" checked>
                            <label class="form-check-label">Credit Card
                                <p class="text-muted small mb-0">Lorem ipsum dolor sit amet, consectetur adipisicing
                                    elit.
                                </p>
                            </label>
                        </div>
                        <fieldset disabled>
                            <div class="row">
                                <div class="col-sm-12 col-lg-6">
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" placeholder="0000 0000 0000 0000">
                                        <span class="input-group-text"><i class="bi bi-credit-card"></i></span>
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class=" input-group mb-3">
                                        <input type="text" class="form-control" placeholder="MM/YY">
                                    </div>
                                </div>
                                <div class="col-sm-6 col-lg-3">
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" placeholder="CVV">
                                        <span class="input-group-text"><i class="bi bi-info-circle"></i></span>
                                    </div>
                                </div>
                                <div class="input-group col-md-4 mb-3">
                                    <input type="text" class="form-control" placeholder="Card Holder Name">
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <hr class="my-5">
                    <div class="row border p-3 mx-3">
                        <div class="col-lg-9 form-check mb-3">
                            <input class="form-check-input" type="radio" name="payment" id="paypal" value="paypal">
                            <label class="form-check-label">Paypal
                                <p class="text-muted small mb-0">Lorem ipsum dolor, sit amet consectetur adipisicing
                                    elit.
                                    Quas
                                    consequatur sunt atque doloribus odio est, sequi, facere unde porro incidunt ipsum
                                    itaque.
                                </p>
                            </label>

                        </div>
                        <div class="col-6 col-sm-6 col-lg-3 mx-auto">
                            <img src="/images/paypal.jpg" alt="paypal logo" class="w-100">
                        </div>
                    </div>
                </div>
            </div>

            <!-- summary -->
            <div class="col-md-5 col-lg-4 mb-5 px-4">
                <h1 class="h3 mb-3">Summary</h1>
                <hr>
                <!-- products -->
                <div class="mt-3">
                    {{#each products}}
                    <div class="card mb-4 card-cart" style="max-width: 540px;">
                        <div class="row g-0">
                            <div class="d-md-none col-md-4 text-center">
                                <a href="/products/product?id={{this.id}}" class="text-decoration-none link-secondary">
                                    <img src="/images/product.jpg" class="img-fluid w-50" alt="product image"></a>
                            </div>
                            <div class="d-none d-md-block col-md-4">
                                <a href="/products/product?id={{this.id}}" class="text-decoration-none link-secondary">
                                    <img src="/images/product.jpg" class="img-fluid" alt="product image"></a>
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <p class="card-title fw-bold"> <a href="/products/product?id={{this.id}}"
                                            class="text-decoration-none link-dark"> {{this.name}}</a></p>
                                    <p class="card-title">{{this.brand.name}}</p>
                                    <p class="card-text"> $ {{this.price}} x <span>{{this.quantity}}</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    {{/each}}
                </div>

                <!-- total -->
                <div>
                    <div class="row">
                        <div class="col-6">
                            <span class="text-uppercase">Subtotal</span>
                        </div>
                        <div class="col-6 mb-3 text-end pe-5">
                            <span>{{#if subtotal}} {{subtotal}} {{/if}}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <span class="text-uppercase">Taxes</span>
                        </div>
                        <div class="col-6 mb-3 text-end pe-5">
                            <span>{{#if taxes}} {{taxes}} {{/if}}</span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <span class="text-uppercase">Shipping</span>
                        </div>
                        <div class="col-6 mb-3 text-end pe-5">
                            <span class="text-uppercase" id="shipping">Free</span>
                        </div>
                    </div>
                    <hr>
                    <div class="row fs-5">
                        <div class="col-6">
                            <span class="text-uppercase">Total</span>
                        </div>
                        <div class="col-6 text-end pe-5">
                            <span id="total">{{#if total}} {{total}} {{/if}}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- buttons -->
            <div class="mb-5">
                <button type="submit" class="btn btn-secondary px-5">Pay Now</button>
                <a href="/" class="btn btn-outline-secondary px-4">Cancel</a>
            </div>

        </div>

    </form>

</section>

{{else}}

<div class="container">
    <div class="alert alert-warning d-flex align-items-center alert-dismissible " role="alert">
        <span>Please add products in your shopping cart to proceed. <a href="/products/category?id=1"
                style="color: #664d03"> Click
                here</a></span>

        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
</div>

{{/if}}



<script>

    let subtotal = Number(document.getElementById("total").innerHTML);

    const setShipping = (value) => {
        document.getElementById("shipping").innerHTML = value;
        let total;

        if (value === "Free") {
            total = subtotal;
        } else {
            total = subtotal + 20;
        }

        document.getElementById("total").innerHTML = total.toFixed(2);

    }


</script>